(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(34),l=a.n(c),o=(a(70),a(71),a(14)),s=a(5),u=a(7),i=a(13),m=a.n(i),d=a(18),p=a(17),E=a(37),b=a.n(E),f=function(){var e=Object(d.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b()(t).then((function(e){return e})).catch((function(e){return e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v={searchPizza:function(e){return function(t){t({type:"SEARCH_PIZZA",payload:e})}}},g=Object(p.b)(null,v)((function(e){var t=e.searchPizza,a=Object(n.useState)(""),c=Object(s.a)(a,2),l=c[0],o=c[1];return r.a.createElement("div",{className:"search-block"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(l)}},r.a.createElement("div",{className:"form-group row"},r.a.createElement("div",{className:"col-sm-12"},r.a.createElement("input",{type:"text",className:"form-control",onChange:function(e){o(e.currentTarget.value)},value:l}))),r.a.createElement("button",{className:"btn btn-primary"},"\u043f\u043e\u0438\u0441\u043a")))})),h=function(){return r.a.createElement("div",{className:"sidebar"},r.a.createElement(g,null))},O=a(62),j=a(64),N=a(101),k=a(111),y=a(105),S=a(102),z=a(107),x=a(112),P=a(103),I=function(e,t){return O.a(t,e.pizzas)},C=function(e){return j.a((function(t){return I(e,t)}),e.homePage.ids).filter((function(t){return N.a(e.homePage.search,t.name)}))},L=function(e){return e.basket.map((function(t){var a=I(e,t);return{dollar:a.dollar,euro:a.euro,name:a.name}}))},A=function(e){return k.a(e.basket)},_=function(e){var t=y.a(e.basket);return z.a(j.a((function(t){return S.a("count",(a=t.id,e.basket.filter((function(e){return e===a})).length),t);var a})),j.a((function(t){return I(e,t)})))(t)},w=function(e){return{totalPriceInDollar:z.a(x.a,P.a("dollar"),j.a((function(t){return I(e,t)})))(e.basket),totalPriceInEuro:z.a(x.a,P.a("euro"),j.a((function(t){return I(e,t)})))(e.basket)}},Z=a(108),F=(a(94),{fetchPizzas:function(){return function(){var e=Object(d.a)(m.a.mark((function e(t){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"FETCH_PIZZAS_START"}),e.prev=1,e.next=4,f("/api/pizza");case 4:a=e.sent,t({type:"FETCH_PIZZAS_SUCCESS",payload:a.data}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("err",e.t0),t({type:"FETCH_PIZZAS_FAILUER",payload:e.t0,error:!0});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},addPizzaToBasket:function(e){return function(t){t({type:"ADD_PIZZA_TO_BASKET",payload:e})}}}),B=Object(p.b)((function(e){return{pizzas:C(e)}}),F)((function(e){var t=e.pizzas,a=e.fetchPizzas,c=e.addPizzaToBasket;Object(n.useEffect)((function(){(function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[a]);return r.a.createElement("div",{className:"home-page"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-2"},r.a.createElement(h,null)),r.a.createElement("div",{className:"col-sm-10"},r.a.createElement("div",{className:"row"},t.map((function(e){return function(e){var t="".concat(Z.a(40,e.description),"...");return r.a.createElement("div",{className:"col-sm-4",key:e.id},r.a.createElement("div",{className:"card card-pizza"},r.a.createElement("div",{className:"card-pizza-image"},r.a.createElement("img",{src:e.image,className:"card-img-top",alt:"img"})),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",{className:"card-text"},e.name),r.a.createElement("p",{className:"card-text"},t),r.a.createElement("p",{className:"card-text"},"\u0446\u0435\u043d\u0430: $",e.dollar," / \u20ac",e.euro),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return c(e.id)}},"\u041a\u0423\u041f\u0418\u0422\u042c!"))))}(e)}))))))})),T=a(63),D=a(110),R=a(6),U=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(null),l=Object(s.a)(c,2),o=l[0],u=l[1],i=Object(n.useState)(""),p=Object(s.a)(i,2),E=p[0],f=p[1],v=Object(n.useState)({}),g=Object(s.a)(v,2),h=g[0],O=g[1],j=Object(n.useState)(""),N=Object(s.a)(j,2),k=N[0],y=N[1],S=Object(n.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u(null),O(t),r(!0),y(e)}),[]);Object(n.useEffect)((function(){var e;if(a){var t=Object(R.a)(Object(R.a)({},h),{headers:{authorization:null!==(e=localStorage.getItem("token"))&&void 0!==e?e:""}});(function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b()(k,t).then((function(e){r(!1),u(e.data)})).catch((function(e){if(e&&e.response){var t=e.response.data.message?e.response.data.message:e.response.data;f(t),r(!1)}}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}}),[a,k,h]);var z=Object(n.useCallback)((function(){return f("")}),[]);return{isLoading:a,response:o,error:E,doFetch:S,clearError:z}},H=(a(95),{removePizzaFromBasket:function(e){return function(t){t({type:"REMOVE_PIZZA_FROM_BASKET",payload:e})}},clearBasket:function(e){return function(e){e({type:"CLEAR_BASKET"})}}}),K=Object(p.b)((function(e){return{pizzasJson:L(e),pizzas:_(e),totalBusketPrice:w(e)}}),H)((function(e){var t=e.pizzas,a=e.totalBusketPrice,c=e.removePizzaFromBasket,l=e.pizzasJson,o=e.clearBasket,u=Object(n.useState)(""),i=Object(s.a)(u,2),m=i[0],d=i[1],p=Object(n.useState)(""),E=Object(s.a)(p,2),b=E[0],f=E[1],v=U(),g=v.isLoading,h=v.response,O=v.doFetch,j=v.error;if(Object(n.useEffect)((function(){!j&&h&&(d(""),f(""),o())}),[o,d,f,j,h]),D.a(t))return r.a.createElement("div",{className:"basket-is-empty"},"\u041a\u043e\u0440\u0437\u0438\u043d\u0430 \u043f\u0443\u0441\u0442\u0430");var N=a.totalPriceInDollar,k=a.totalPriceInEuro;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"basket-table"},r.a.createElement("table",{className:"table table-striped"},r.a.createElement("tbody",null,t.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",{className:"first-column-checkout"},r.a.createElement("img",{className:"img-thumbnail",src:e.image,alt:e.name})),r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.count),r.a.createElement("td",null,r.a.createElement("span",{onClick:function(){return c(e.id)},className:"delete-pizza"},"x")))})),r.a.createElement("tr",null,r.a.createElement("td",{className:"first-column-checkout"},"\u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430"),r.a.createElement("td",null,"$4 / \u20ac3")))),r.a.createElement("div",{className:"text-right basket-total-price"},"\u041e\u0431\u0449\u0430\u044f \u0446\u0435\u043d\u0430 c \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u043e\u0439 - $",N+4," / \u20ac",k+4)),r.a.createElement("div",{className:"auth-block"},r.a.createElement("h1",{className:"text-center"},"\u0424\u043e\u0440\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var t={name:m,address:b,jsonData:Object(T.a)(l),totalPriceDollar:N+4,totalPriceEuro:k+4};d(""),f(""),o(),O("/api/order/makeOrder",{method:"post",data:t})}},r.a.createElement("div",null,r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},"\u0418\u043c\u044f")),r.a.createElement("input",{placeholder:"\u0418\u043c\u044f",id:"name",type:"text",name:"name",required:!0,className:"form-control",onChange:function(e){return d(e.target.value)}})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},"\u0410\u0434\u0440\u0435\u0441")),r.a.createElement("input",{placeholder:"\u0410\u0434\u0440\u0435\u0441",id:"adrress",type:"text",required:!0,name:"adrress",className:"form-control",onChange:function(e){return f(e.target.value)}})),r.a.createElement("button",{disabled:g,className:"btn btn-primary",type:"submit"},"\u0417\u0430\u043a\u0430\u0437\u0430\u0442\u044c")))))})),M=(a(96),function(){var e=U(),t=e.isLoading,a=e.response,c=e.doFetch;return Object(n.useEffect)((function(){c("/api/order/get-orders")}),[c]),t||!a?r.a.createElement("div",null,"Loading..."):r.a.createElement("div",{className:"auth-block"},r.a.createElement("h1",{className:"text-center"},"\u0418\u0441\u0442\u043e\u0440\u0438\u044f"),r.a.createElement("table",{className:"table table-dark"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{scope:"col"},"#"),r.a.createElement("th",{scope:"col"},"\u0418\u043c\u044f"),r.a.createElement("th",{scope:"col"},"\u0410\u0434\u0440\u0435\u0441"),r.a.createElement("th",{scope:"col"},"P\u0430\u043a\u0430\u0437"),r.a.createElement("th",{scope:"col"},"\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430"))),r.a.createElement("tbody",null,a.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("th",{scope:"row"},t),r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.address),r.a.createElement("td",{className:"table-total-sum-td"},e.jsonData.map((function(e){return r.a.createElement("div",{className:"table-total-sum"},r.a.createElement("p",null,"\u041f\u0438\u0446\u0446\u0430 - ",e.name),r.a.createElement("p",null,"\u0446\u0435\u043d\u043d\u0430 - $",e.dollar," / \u20ac",e.euro))}))),r.a.createElement("td",null,"$",e.totalPriceDollar," / \u20ac",e.totalPriceEuro))})))))}),$=Object(n.createContext)([{},function(){}]),J=function(e){var t=e.children,a=Object(n.useState)({isLoading:!1,isLoggedIn:null,currentUser:null}),c=Object(s.a)(a,2),l=c[0],o=c[1];return r.a.createElement($.Provider,{value:[l,o]},t)},q=(a(97),function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(""),i=Object(s.a)(l,2),m=i[0],d=i[1],p="/login"===Object(u.h)().pathname,E=p?"\u0412\u043e\u0439\u0442\u0438":"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",b=p?"/registration":"/login",f=p?"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f?":"\u0423\u0436\u0435 \u0435\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?",v=p?"/api/auth/login":"/api/auth/registration",g=U(),h=g.isLoading,O=g.response,j=g.doFetch,N=Object(n.useContext)($),k=Object(s.a)(N,2)[1],y=Object(u.g)();Object(n.useEffect)((function(){O&&(localStorage.setItem("token",O.user.token),k((function(e){return Object(R.a)(Object(R.a)({},e),{},{isLoggedIn:!0,isLoading:!1,currentUser:O.user})})),y.push("/"))}),[O,k,y]);return r.a.createElement("div",{className:"auth-block"},r.a.createElement("h1",{className:"text-center"},E),r.a.createElement("p",{className:"text-center is-login"},r.a.createElement(o.b,{to:b},f)),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),j(v,{method:"post",data:{email:a,password:m}})}},r.a.createElement("div",null,r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},"Email")),r.a.createElement("input",{placeholder:"email",id:"email",type:"email",name:"email",className:"form-control",onChange:function(e){return c(e.target.value)}})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text"},"Password")),r.a.createElement("input",{placeholder:"\u0437assword",id:"password",type:"password",name:"password",className:"form-control",onChange:function(e){return d(e.target.value)}})),r.a.createElement("button",{disabled:h,className:"btn btn-primary",type:"submit"},E))))}),V=function(){var e=Object(n.useContext)($),t=Object(s.a)(e,1)[0];return r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/",exact:!0},r.a.createElement(B,null)),r.a.createElement(u.b,{path:"/basket"},r.a.createElement(K,null)),!t.isLoggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement(u.b,{path:"/login"},r.a.createElement(q,null)),r.a.createElement(u.b,{path:"/registration"},r.a.createElement(q,null))),t.isLoggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement(u.b,{path:"/history"},r.a.createElement(M,null))),r.a.createElement(u.a,{to:"/"}))},W=a(19),G=a(60),Q=a(61),X=a(106),Y=a(113),ee={},te={ids:[],search:""},ae=a(109),ne=a(104),re=[],ce=Object(W.combineReducers)({homePage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"FETCH_PIZZAS_SUCCESS":var r=P.a("id");return Y.a(e,{ids:r(n)});case"SEARCH_PIZZA":return Y.a(e,{search:n});default:return e}},basket:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"ADD_PIZZA_TO_BASKET":return ae.a(n,e);case"REMOVE_PIZZA_FROM_BASKET":return ne.a([n],e);case"CLEAR_BASKET":return[];default:return e}},pizzas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"FETCH_PIZZAS_SUCCESS":var r=X.a(O.a("id"),n);return Y.a(e,r);default:return e}}}),le=Object(W.createStore)(ce,Object(G.composeWithDevTools)(Object(W.applyMiddleware)(Q.a))),oe=Object(p.b)((function(e){return{totalBusketCount:A(e),totalBusketPrice:w(e)}}))((function(e){var t=e.totalBusketCount,a=e.totalBusketPrice,n=a.totalPriceInDollar,c=a.totalPriceInEuro;return r.a.createElement("div",{className:"basket-icon"},r.a.createElement("i",{className:"fa fa-shopping-basket","aria-hidden":"true"},r.a.createElement("span",null,t))," $",n," / \u20ac",c)})),se=function(){var e=Object(n.useContext)($),t=Object(s.a)(e,2)[1],a=U(),r=a.response,c=a.error,l=a.doFetch,o=a.clearError,u=Object(n.useState)(!1),i=Object(s.a)(u,2),m=i[0],d=i[1],p=Object(n.useState)(!1),E=Object(s.a)(p,2),b=E[0],f=E[1],v=Object(n.useCallback)((function(){t({isLoading:!1,isLoggedIn:null,currentUser:null}),localStorage.removeItem("token")}),[t]);return Object(n.useEffect)((function(){if(!localStorage.getItem("token"))return t((function(e){return Object(R.a)(Object(R.a)({},e),{},{isLoading:!1,isLoggedIn:!1})})),void d(!0);l("/api/auth/check"),t((function(e){return Object(R.a)(Object(R.a)({},e),{},{isLoading:!0})}))}),[l,t]),Object(n.useEffect)((function(){c&&(t((function(e){return Object(R.a)(Object(R.a)({},e),{},{isLoggedIn:!1,isLoading:!1,currentUser:null})})),d(!0),localStorage.removeItem("token"),o())}),[c,o,t]),Object(n.useEffect)((function(){r&&(t((function(e){return Object(R.a)(Object(R.a)({},e),{},{isLoggedIn:!0,isLoading:!1,currentUser:r.user})})),d(!0),f(!0))}),[r,t]),{ready:m,isAuth:b,logout:v}},ue=(a(99),function(){var e=Object(u.g)(),t=se().logout,a=Object(n.useContext)($),c=Object(s.a)(a,1)[0];return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},r.a.createElement(o.c,{to:"/",exact:!0,className:"navbar-brand  mr-auto"},"Pizzaaa"),!c.isLoading&&r.a.createElement("div",{className:"",id:"navbarNav"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.c,{to:"/",exact:!0,className:"nav-link"},"\u041c\u0435\u043d\u044e")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.c,{to:"/basket",exact:!0,className:"nav-link"},"\u041a\u043e\u0440\u0437\u0438\u043d\u0430")),!c.isLoggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.c,{to:"/login",className:"nav-link"},"\u0412\u043e\u0439\u0442\u0438")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.c,{to:"/registration",exact:!0,className:"nav-link"},"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"))),c.isLoggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.c,{to:"/history",exact:!0,className:"nav-link"},"\u0418\u0441\u0442\u043e\u0440\u0438\u044f")),r.a.createElement("li",{className:"nav-item"},r.a.createElement("button",{className:"nav-link nav-link-button",onClick:function(a){a.preventDefault(),t(),e.push("/")}},"\u0412\u044b\u0439\u0442\u0438"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(oe,null)))))}),ie=function(e){var t=e.children;return se().ready?r.a.createElement("div",null,r.a.createElement(ue,null),r.a.createElement("div",{className:"container"},t)):r.a.createElement("div",{className:"spinner-block"},r.a.createElement("div",{className:"spinner-border text-primary",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))},me=function(e){var t=e.children,a=Object(n.useContext)($),r=Object(s.a)(a,2)[1],c=U(),l=c.doFetch,o=c.response;return Object(n.useEffect)((function(){localStorage.getItem("token")?(l("/api/auth/check"),r((function(e){return Object(R.a)(Object(R.a)({},e),{},{isLoading:!0})}))):r((function(e){return Object(R.a)(Object(R.a)({},e),{},{isLoggedIn:!1})}))}),[l,r]),Object(n.useEffect)((function(){o&&(localStorage.setItem("token",o.user.token),r((function(e){return Object(R.a)(Object(R.a)({},e),{},{isLoggedIn:!0,isLoading:!1,currentUser:o.user})})))}),[o,r]),t},de=function(){return r.a.createElement(me,null,r.a.createElement(J,null,r.a.createElement(p.a,{store:le},r.a.createElement(o.a,null,r.a.createElement(ie,null,r.a.createElement(V,null))))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(de,null)),document.getElementById("root"))},65:function(e,t,a){e.exports=a(100)},70:function(e,t,a){},71:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){},99:function(e,t,a){}},[[65,1,2]]]);
//# sourceMappingURL=main.8105dfbe.chunk.js.map